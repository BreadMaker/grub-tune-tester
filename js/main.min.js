var requestId;function ready(e){if(document.readyState!="loading"){e()}else{document.addEventListener("DOMContentLoaded",e)}}function createTuneObj(e){var t=e.split(" ");var n=Object();n.tempo=parseInt(t[0]);n.tune=[];t=t.splice(1);while(t.length>0){n.tune.push({frequency:parseInt(t[0]),duration:parseInt(t[1])});t=t.splice(2)}return n}function calculateDuration(e){var t=Number();for(var n=0;n<e.tune.length;n++){t+=1/(e.tempo/60)*e.tune[n].duration}document.getElementById("notes").textContent=e.tune.length;document.getElementById("duration").textContent=Math.round(t*1e3)+"ms";document.getElementById("duration").title=(t%1==0?t:t.toFixed(3))+"s"}function play(e){let t=new(window.AudioContext||window.webkitAudioContext),n=t.currentTime,a=e.tune.length,d=0,l=t.createGain();for(var o=0;o<a;o++){let u=t.createOscillator();u.connect(l);l.connect(t.destination);l.gain.value=.125;d=1/(e.tempo/60)*e.tune[o].duration;u.type="square";u.frequency.value=e.tune[o].frequency;if(o==a-1){u.onended=()=>{document.getElementById("tune-select").classList.remove("disabled");document.getElementById("tune-select").removeAttribute("disabled");document.getElementById("play").classList.remove("d-none");document.getElementById("stop").classList.add("d-none");cancelAnimationFrame(requestId)}}e.tune[o].oscillator=u;u.start(n);u.stop(n+d);n+=d}document.getElementById("stop").addEventListener("click",(()=>{for(let t of e.tune){t.oscillator.stop()}}),{once:true})}function loadSelect(){const e=new URLSearchParams(window.location.search),t=Object.fromEntries(e.entries()),n=t["tune"];let a=[{title:"Default tune",tune:"480 440 1"},{title:"Mario Coin FX",tune:"600 988 1 1319 4"},{title:"Mario Bros Powerup FX",tune:"1750 523 1 392 1 523 1 659 1 784 1 1047 1 784 1 415 1 523 1 622 1 831 1 622 1 831 1 1046 1 1244 1 1661 1 1244 1 466 1 587 1 698 1 932 1 1175 1 1397 1 1865 1 1397 1"},{title:"Mario Bros Music Intro",tune:"410 668 1 668 1 0 1 668 1 0 1 522 1 668 1 0 1 784 2 0 2 392 2"},{title:"Imperial March 1st Verse",tune:"550 392 3 0 1 392 3 0 1 392 3 0 1 311 3 466 1 392 3 0 1 311 3 466 1 392 6 0 2 587 3 0 1 587 3 0 1 587 3 0 1 622 3 466 1 370 3 0 1 311 3 466 1 392 4"},{title:"Close Encounters",tune:"400 880 2 988 2 783 2 392 2 587 3"},{title:"Wolfestein 3D Music Intro",tune:"300 131 1 196 1 196 1 196 1 294 1 196 1 294 1 196 1 131 2"},{title:"Joe Hisaishi's „One Summer Day“ OP chord",tune:"1536 349 3 698 1 523 2 784 1 1319 6"}],d=document.getElementById("tune-input"),l=document.getElementById("tune-select");l.remove(0);for(let e of a){let t=document.createElement("option");t.textContent=e.title;t.value=e.tune;l.appendChild(t)}let o=document.createElement("option");o.textContent="URL custom input";o.id="url-option";o.value="";o.hidden=true;l.appendChild(o);o=document.createElement("option");o.textContent="Custom input";o.id="custom-option";o.value="";l.appendChild(o);l.removeAttribute("disabled");document.getElementById("tune-input").value=l.value;if(n!=undefined){let e=document.getElementById("url-option");e.value=n;e.hidden=false;e.selected=true;d.readonly=false;d.value=n}}function showWarningMessage(e){document.getElementById("warning-alert").classList.remove("d-none");document.getElementById("tune-info").classList.add("d-none");document.getElementById("warning-alert-message").textContent=e;document.getElementById("play").classList.add("disabled");document.getElementById("play").setAttribute("disabled","disabled")}function validateTuneInput(e){let t=e.split(" "),n=true,a=false,d=document.getElementById("warning-alert"),l=document.getElementById("tune-info");for(let e of t){if(isNaN(e)){n=false;break}else if(e===""){a=true;break}}if(e.length==0){showWarningMessage("Input at least one note.")}else if(!n){showWarningMessage("Please enter only numbers.")}else if(a){showWarningMessage("Only one space between numbers.")}else{if(t.length<3){showWarningMessage("Input at least one note.")}else if(t.length>=3&&t.length%2==0){showWarningMessage("One more number to define a note.")}else{document.getElementById("play").classList.remove("disabled");document.getElementById("play").removeAttribute("disabled");d.classList.add("d-none");l.classList.remove("d-none");calculateDuration(createTuneObj(e))}}}function addFormEvents(){let e=document.getElementById("tune-select"),t=document.getElementById("tune-input"),n=document.getElementById("warning-alert"),a=document.getElementById("tune-info");e.addEventListener("change",(()=>{t.value=e.value;t.parentNode.dataset.replicatedValue=t.value;if(e.value===""){document.getElementById("play").classList.add("disabled");document.getElementById("play").setAttribute("disabled","disabled");n.classList.remove("d-none");a.classList.add("d-none");t.removeAttribute("readonly")}else{document.getElementById("play").classList.remove("disabled");document.getElementById("play").removeAttribute("disabled");n.classList.add("d-none");a.classList.remove("d-none");calculateDuration(createTuneObj(e.value));t.readonly=true}validateTuneInput(t.value)}));t.addEventListener("input",(()=>{t.parentNode.dataset.replicatedValue=t.value;document.getElementById("custom-option").selected=true;validateTuneInput(t.value)}));t.addEventListener("paste",(()=>{t.parentNode.dataset.replicatedValue=t.value;document.getElementById("custom-option").selected=true;validateTuneInput(t.value)}));document.getElementById("tune-form").addEventListener("submit",(e=>{e.preventDefault();document.getElementById("tune-select").classList.add("disabled");document.getElementById("tune-select").setAttribute("disabled","disabled");document.getElementById("play").classList.add("d-none");document.getElementById("stop").classList.remove("d-none");requestId=requestAnimationFrame((()=>{play(createTuneObj(t.value))}))}))}ready((()=>{let e=document.getElementById("tune-input");e.value="Loading...";loadSelect();addFormEvents();validateTuneInput(e.value);calculateDuration(createTuneObj(e.value));new bootstrap.Popover("#trivia");new ClipboardJS("#copy",{text:()=>e.value}).on("success",(()=>{var e=new bootstrap.Tooltip(document.getElementById("copy"),{title:"Copied!",trigger:"hover"});e.show();document.getElementById("copy").addEventListener("hidden.bs.tooltip",(()=>{e.dispose()}),{once:true})}))}));
//# sourceMappingURL=main.min.js.map